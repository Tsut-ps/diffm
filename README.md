# diffm
動画差分を表示 & グラフ化するプログラム。  
リアルタイム計算。  
30フレームごとに動画差分を描画、グラフを更新するようになっている（書き換えれば調整可能）。  

左がリアルタイム差分表示。右が差分グラフ。
![image](https://github.com/Tsut-ps/diffm/assets/73014392/9d305d27-b9a9-46fd-a404-c967f4a8ddfd)

しきい値以上の比較画像を出力することも可能。
![image](https://github.com/Tsut-ps/diffm/assets/73014392/ba69f87a-c8a8-4f0e-9ed2-be21ae33ee5a)

## どうして作ったの？
- 動画プロジェクトの書き出し後に変更点が知りたかった
- AviUtlで差分比較するのが面倒だった
- グラフ化して定量的に差分比較したかった
- ライブラリを使ってみたかった（あまり使ったことがないので）

## もっと詳しく（経緯）
[PythonとOpenCVで画像を比較して保存する](https://scrapbox.io/Tsut-ps/Python%E3%81%A8OpenCV%E3%81%A7%E7%94%BB%E5%83%8F%E3%82%92%E6%AF%94%E8%BC%83%E3%81%97%E3%81%A6%E4%BF%9D%E5%AD%98%E3%81%99%E3%82%8B)

### ToDo
演算がちょっと重めなので、軽量化したい。

## 確認動作環境
- Windows 11
- VSCode 1.83.1
- Python 3.11.6 (Microsoft Store)

## 必要なライブラリ
- OpenCV  
  ```
  pip install opencv-python
  ```
- NumPy
  ```
  pip install numpy
  ```
- Matplotlib
  ```
  pip install matplotlib
  ```

## 実行
1. どこか好きなところに diffm.py を保存
1. 実行できるもので開く
1. 引数を指定して実行  

```
> python diffm.py "A.mp4" "B.mp4" 60 1
```

- 第1引数 = 動画A
- 第2引数 = 動画B
- 第3引数 = 描画間隔（オプション）
- 第4引数 = しきい値（オプション）


### 制約
- 1 <= 描画間隔 (整数)
- 0 <= しきい値 <= 255 (小数)

## 終了
「diffm」ウィンドウをバツで閉じると、他のウィンドウも閉じる。

## 描画間隔について
1を指定すると、1フレームごとにグラフや動画を更新します。その分処理は重めです。  
そのため、動画の1秒間あたりのフレーム数(24/30/60フレーム等)を推奨してます。こうすることで、動画の1秒分ごとに更新されます。
※この設定はグラフのプロットには影響しません。
